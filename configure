#!/bin/sh

set -euo pipefail

echo "Generating makefile..."
cat > Makefile <<EOF
.PHONY: all clean install

CC=clang
override CFLAGS += -Wall -Werror
SOURCES:=\$(wildcard ./*.c)
OBJ:=\$(patsubst ./%.c,./%.o,\$(SOURCES))
EXE=simple

all: \$(EXE)

clean:
	rm \$(EXE)

\$(EXE): \$(OBJ)
	\$(CC) \$(LDFLAGS) \$^ -o \$@ 

\$(OBJ): ./%.o : ./%.c
	\$(CC) -c \$(CFLAGS) \$^

install: all
	
EOF
echo "All set!  Run make to compile the shared object file."